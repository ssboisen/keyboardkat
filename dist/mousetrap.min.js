!function(e,t){function n(e,t,n){return e.addEventListener?void e.addEventListener(t,n,!1):void e.attachEvent("on"+t,n)}function r(e){if("keypress"==e.type){var t=String.fromCharCode(e.which);return e.shiftKey||(t=t.toLowerCase()),t}return K[e.which]?K[e.which]:q[e.which]?q[e.which]:String.fromCharCode(e.which).toLowerCase()}function o(e,t){return e.sort().join(",")===t.sort().join(",")}function i(e){e=e||{};var t,n=!1;for(t in A)e[t]?n=!0:A[t]=0;n||(j=!1)}function a(e,t,n,r,i,a){var c,u,s=[],f=n.type;if(!L[e])return[];for("keyup"==f&&p(e)&&(t=[e]),c=0;c<L[e].length;++c)if(u=L[e][c],(r||!u.seq||A[u.seq]==u.level)&&f==u.action&&("keypress"==f&&!n.metaKey&&!n.ctrlKey||o(t,u.modifiers))){var l=!r&&u.combo==i,h=r&&u.seq==r&&u.level==a;(l||h)&&L[e].splice(c,1),s.push(u)}return s}function c(e){var t=[];return e.shiftKey&&t.push("shift"),e.altKey&&t.push("alt"),e.ctrlKey&&t.push("ctrl"),e.metaKey&&t.push("meta"),t}function u(e){return e.preventDefault?void e.preventDefault():void(e.returnValue=!1)}function s(e){return e.stopPropagation?void e.stopPropagation():void(e.cancelBubble=!0)}function f(e,t,n,r){D.stopCallback(t,t.target||t.srcElement,n,r)||e(t,n)===!1&&(u(t),s(t))}function l(e,t,n){var r,o=a(e,t,n),c={},u=0,s=!1;for(r=0;r<o.length;++r)o[r].seq&&(u=Math.max(u,o[r].level));for(r=0;r<o.length;++r)if(o[r].seq){if(o[r].level!=u)continue;s=!0,c[o[r].seq]=1,f(o[r].callback,n,o[r].combo,o[r].seq)}else s||f(o[r].callback,n,o[r].combo);var l="keypress"==n.type&&S;n.type!=j||p(e)||l||i(c),S=s&&"keydown"==n.type}function h(e){"number"!=typeof e.which&&(e.which=e.keyCode);var t=r(e);if(t)return"keyup"==e.type&&M===t?void(M=!1):void D.handleKey(t,c(e),e)}function p(e){return"shift"==e||"ctrl"==e||"alt"==e||"meta"==e}function d(){clearTimeout(E),E=setTimeout(i,1e3)}function y(){if(!C){C={};for(var e in K)e>95&&112>e||K.hasOwnProperty(e)&&(C[K[e]]=e)}return C}function m(e,t,n){return n||(n=y()[e]?"keydown":"keypress"),"keypress"==n&&t.length&&(n="keydown"),n}function v(e,t,n,o){function a(t){return function(){j=t,++A[e],d()}}function c(t){f(n,t,e),"keyup"!==o&&(M=r(t)),setTimeout(i,10)}A[e]=0;for(var u=0;u<t.length;++u){var s=u+1===t.length,l=s?c:a(o||g(t[u+1]).action);w(t[u],l,o,e,u)}}function k(e){return"+"===e?["+"]:e.split("+")}function g(e,t){var n,r,o,i=[];for(n=k(e),o=0;o<n.length;++o)r=n[o],T[r]&&(r=T[r]),t&&"keypress"!=t&&P[r]&&(r=P[r],i.push("shift")),p(r)&&i.push(r);return t=m(r,i,t),{key:r,modifiers:i,action:t}}function w(e,t,n,r,o){N[e+":"+n]=t,e=e.replace(/\s+/g," ");var i,c=e.split(" ");return c.length>1?void v(e,c,t,n):(i=g(e,n),L[i.key]=L[i.key]||[],a(i.key,i.modifiers,{type:i.action},r,e,o),void L[i.key][r?"unshift":"push"]({callback:t,modifiers:i.modifiers,action:i.action,seq:r,level:o,combo:e}))}function b(e,t,n){for(var r=0;r<e.length;++r)w(e[r],t,n)}for(var C,E,K={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},q={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},P={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},T={option:"alt",command:"meta","return":"enter",escape:"esc",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},L={},N={},A={},M=!1,S=!1,j=!1,x=1;20>x;++x)K[111+x]="f"+x;for(x=0;9>=x;++x)K[x+96]=x;n(t,"keypress",h),n(t,"keydown",h),n(t,"keyup",h);var D={bind:function(e,t,n){return e=e instanceof Array?e:[e],b(e,t,n),this},unbind:function(e,t){return D.bind(e,function(){},t)},trigger:function(e,t){return N[e+":"+t]&&N[e+":"+t]({},e),this},reset:function(){return L={},N={},this},stopCallback:function(e,t){return(" "+t.className+" ").indexOf(" mousetrap ")>-1?!1:"INPUT"==t.tagName||"SELECT"==t.tagName||"TEXTAREA"==t.tagName||t.isContentEditable},handleKey:l};e.Mousetrap=D,"function"==typeof define&&define.amd&&define(D)}(window,document);